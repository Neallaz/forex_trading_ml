version: '3.8'

services:
  forex-app:
    build:
      context: .
      target: development
    container_name: forex-ml-trading-dev
    ports:
      - "8501:8501"
      - "5678:5678"  # For debugging
    environment:
      - PYTHONPATH=/app
      - PYTHONUNBUFFERED=1
      - DEBUG=true
      - ALPHA_VANTAGE_API_KEY=demo
    volumes:
      # Hot-reload برای development
      - .:/app
    command: streamlit run dashboard/app.py --server.port=8501 --server.address=0.0.0.0 --server.runOnSave=true
    stdin_open: true
    tty: true
    profiles:
      - development

  # Auto-reload service for development
  watch:
    image: redislabs/rebloom:latest
    container_name: forex-watch
    profiles:
      - development
    command: watchmedo auto-restart --pattern="*.py" --recursive --signal SIGTERM python main.py